<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 Topic Modelling | Dicours Analysis</title>
  <meta name="description" content="Chapter 6 Topic Modelling | Dicours Analysis" />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 Topic Modelling | Dicours Analysis" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 Topic Modelling | Dicours Analysis" />
  
  
  

<meta name="author" content="Eugénie Mathieu, Maeva Marin, Hadrien Renger, Wajma Nazim" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="similarities.html"/>
<link rel="next" href="word-embedding.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.15/datatables.js"></script>
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Basic introduction</a></li>
<li class="chapter" data-level="2" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>2</b> Introduction</a><ul>
<li class="chapter" data-level="2.1" data-path="introduction.html"><a href="introduction.html#overview-and-motivation"><i class="fa fa-check"></i><b>2.1</b> Overview and Motivation</a></li>
<li class="chapter" data-level="2.2" data-path="introduction.html"><a href="introduction.html#data-loadind"><i class="fa fa-check"></i><b>2.2</b> Data loadind</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="eda.html"><a href="eda.html"><i class="fa fa-check"></i><b>3</b> EDA</a><ul>
<li class="chapter" data-level="3.1" data-path="eda.html"><a href="eda.html#data-acquisition"><i class="fa fa-check"></i><b>3.1</b> Data Acquisition</a><ul>
<li class="chapter" data-level="3.1.1" data-path="eda.html"><a href="eda.html#emmanuel-macron"><i class="fa fa-check"></i><b>3.1.1</b> Emmanuel Macron</a></li>
<li class="chapter" data-level="3.1.2" data-path="eda.html"><a href="eda.html#boris-johnson"><i class="fa fa-check"></i><b>3.1.2</b> Boris Johnson</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="eda.html"><a href="eda.html#tokenisation-lemmatization-cleaning"><i class="fa fa-check"></i><b>3.2</b> Tokenisation, Lemmatization &amp; Cleaning</a><ul>
<li class="chapter" data-level="3.2.1" data-path="eda.html"><a href="eda.html#emmanuel-macron-1"><i class="fa fa-check"></i><b>3.2.1</b> Emmanuel Macron</a></li>
<li class="chapter" data-level="3.2.2" data-path="eda.html"><a href="eda.html#boris-johnson-1"><i class="fa fa-check"></i><b>3.2.2</b> Boris Johnson</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="eda.html"><a href="eda.html#document-term-matrix-dtm"><i class="fa fa-check"></i><b>3.3</b> Document-Term Matrix DTM</a><ul>
<li class="chapter" data-level="3.3.1" data-path="eda.html"><a href="eda.html#table"><i class="fa fa-check"></i><b>3.3.1</b> Table</a></li>
<li class="chapter" data-level="3.3.2" data-path="eda.html"><a href="eda.html#most-frequent-words"><i class="fa fa-check"></i><b>3.3.2</b> Most frequent words</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="eda.html"><a href="eda.html#tf-idf"><i class="fa fa-check"></i><b>3.4</b> TF-IDF</a><ul>
<li class="chapter" data-level="3.4.1" data-path="eda.html"><a href="eda.html#emmanuel-macron-2"><i class="fa fa-check"></i><b>3.4.1</b> Emmanuel Macron</a></li>
<li class="chapter" data-level="3.4.2" data-path="eda.html"><a href="eda.html#boris-johnson-2"><i class="fa fa-check"></i><b>3.4.2</b> Boris Johnson</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="eda.html"><a href="eda.html#cloud-of-words"><i class="fa fa-check"></i><b>3.5</b> Cloud of Words</a><ul>
<li class="chapter" data-level="3.5.1" data-path="eda.html"><a href="eda.html#usind-dfm"><i class="fa fa-check"></i><b>3.5.1</b> Usind DFM</a></li>
<li class="chapter" data-level="3.5.2" data-path="eda.html"><a href="eda.html#using-tf-idf"><i class="fa fa-check"></i><b>3.5.2</b> Using TF-IDF</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="eda.html"><a href="eda.html#lexical-divesity-token-type-ratio-ttr"><i class="fa fa-check"></i><b>3.6</b> Lexical Divesity Token Type Ratio TTR</a><ul>
<li class="chapter" data-level="3.6.1" data-path="eda.html"><a href="eda.html#emmanuel-macron-3"><i class="fa fa-check"></i><b>3.6.1</b> Emmanuel Macron</a></li>
<li class="chapter" data-level="3.6.2" data-path="eda.html"><a href="eda.html#boris-johnson-3"><i class="fa fa-check"></i><b>3.6.2</b> Boris Johnson</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="eda.html"><a href="eda.html#zipfs-law"><i class="fa fa-check"></i><b>3.7</b> Zipf’s Law</a><ul>
<li class="chapter" data-level="3.7.1" data-path="eda.html"><a href="eda.html#emmanuel-macron-4"><i class="fa fa-check"></i><b>3.7.1</b> Emmanuel Macron</a></li>
<li class="chapter" data-level="3.7.2" data-path="eda.html"><a href="eda.html#boris-johnson-4"><i class="fa fa-check"></i><b>3.7.2</b> Boris Johnson</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="eda.html"><a href="eda.html#yules-index"><i class="fa fa-check"></i><b>3.8</b> Yule’s index</a><ul>
<li class="chapter" data-level="3.8.1" data-path="eda.html"><a href="eda.html#emmanuel-macron-5"><i class="fa fa-check"></i><b>3.8.1</b> Emmanuel Macron</a></li>
<li class="chapter" data-level="3.8.2" data-path="eda.html"><a href="eda.html#boris-johnson-5"><i class="fa fa-check"></i><b>3.8.2</b> Boris Johnson</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="eda.html"><a href="eda.html#mattr"><i class="fa fa-check"></i><b>3.9</b> MATTR</a><ul>
<li class="chapter" data-level="3.9.1" data-path="eda.html"><a href="eda.html#emmanuel-macron-6"><i class="fa fa-check"></i><b>3.9.1</b> Emmanuel Macron</a></li>
<li class="chapter" data-level="3.9.2" data-path="eda.html"><a href="eda.html#boris-johnson-6"><i class="fa fa-check"></i><b>3.9.2</b> Boris Johnson</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="sentiment-analysis.html"><a href="sentiment-analysis.html"><i class="fa fa-check"></i><b>4</b> Sentiment Analysis</a><ul>
<li class="chapter" data-level="4.1" data-path="sentiment-analysis.html"><a href="sentiment-analysis.html#sentiment-analysis-with-the-sentiment-library-nrc"><i class="fa fa-check"></i><b>4.1</b> Sentiment analysis with the sentiment library “nrc”</a><ul>
<li class="chapter" data-level="4.1.1" data-path="sentiment-analysis.html"><a href="sentiment-analysis.html#with-quanteda"><i class="fa fa-check"></i><b>4.1.1</b> With quanteda</a></li>
<li class="chapter" data-level="4.1.2" data-path="sentiment-analysis.html"><a href="sentiment-analysis.html#value-based"><i class="fa fa-check"></i><b>4.1.2</b> Value-based</a></li>
<li class="chapter" data-level="4.1.3" data-path="sentiment-analysis.html"><a href="sentiment-analysis.html#using-valence-shifters"><i class="fa fa-check"></i><b>4.1.3</b> Using valence shifters</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="similarities.html"><a href="similarities.html"><i class="fa fa-check"></i><b>5</b> Similarities</a><ul>
<li class="chapter" data-level="5.1" data-path="similarities.html"><a href="similarities.html#boris"><i class="fa fa-check"></i><b>5.1</b> Boris</a></li>
<li class="chapter" data-level="5.2" data-path="similarities.html"><a href="similarities.html#macron"><i class="fa fa-check"></i><b>5.2</b> Macron</a></li>
<li class="chapter" data-level="5.3" data-path="similarities.html"><a href="similarities.html#comparison"><i class="fa fa-check"></i><b>5.3</b> Comparison</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="topic-modelling.html"><a href="topic-modelling.html"><i class="fa fa-check"></i><b>6</b> Topic Modelling</a><ul>
<li class="chapter" data-level="6.1" data-path="topic-modelling.html"><a href="topic-modelling.html#boris-johnson-7"><i class="fa fa-check"></i><b>6.1</b> Boris Johnson</a><ul>
<li class="chapter" data-level="6.1.1" data-path="topic-modelling.html"><a href="topic-modelling.html#lsa"><i class="fa fa-check"></i><b>6.1.1</b> LSA</a></li>
<li class="chapter" data-level="6.1.2" data-path="topic-modelling.html"><a href="topic-modelling.html#lda"><i class="fa fa-check"></i><b>6.1.2</b> LDA</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="topic-modelling.html"><a href="topic-modelling.html#macron-1"><i class="fa fa-check"></i><b>6.2</b> Macron</a><ul>
<li class="chapter" data-level="6.2.1" data-path="topic-modelling.html"><a href="topic-modelling.html#lsa-1"><i class="fa fa-check"></i><b>6.2.1</b> LSA</a></li>
<li class="chapter" data-level="6.2.2" data-path="topic-modelling.html"><a href="topic-modelling.html#lda-1"><i class="fa fa-check"></i><b>6.2.2</b> LDA</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="topic-modelling.html"><a href="topic-modelling.html#combine"><i class="fa fa-check"></i><b>6.3</b> Combine</a><ul>
<li class="chapter" data-level="6.3.1" data-path="topic-modelling.html"><a href="topic-modelling.html#lsa-2"><i class="fa fa-check"></i><b>6.3.1</b> LSA</a></li>
<li class="chapter" data-level="6.3.2" data-path="topic-modelling.html"><a href="topic-modelling.html#lda-2"><i class="fa fa-check"></i><b>6.3.2</b> LDA</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="word-embedding.html"><a href="word-embedding.html"><i class="fa fa-check"></i><b>7</b> Word Embedding</a><ul>
<li class="chapter" data-level="7.1" data-path="word-embedding.html"><a href="word-embedding.html#boris-johnson-8"><i class="fa fa-check"></i><b>7.1</b> Boris Johnson</a></li>
<li class="chapter" data-level="7.2" data-path="word-embedding.html"><a href="word-embedding.html#macron-2"><i class="fa fa-check"></i><b>7.2</b> Macron</a></li>
<li class="chapter" data-level="7.3" data-path="word-embedding.html"><a href="word-embedding.html#comparison-1"><i class="fa fa-check"></i><b>7.3</b> Comparison</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="supervised-learning.html"><a href="supervised-learning.html"><i class="fa fa-check"></i><b>8</b> Supervised learning</a><ul>
<li class="chapter" data-level="8.1" data-path="supervised-learning.html"><a href="supervised-learning.html#lsa-3"><i class="fa fa-check"></i><b>8.1</b> LSA</a></li>
<li class="chapter" data-level="8.2" data-path="supervised-learning.html"><a href="supervised-learning.html#random-forest"><i class="fa fa-check"></i><b>8.2</b> Random forest</a></li>
<li class="chapter" data-level="8.3" data-path="supervised-learning.html"><a href="supervised-learning.html#improving-the-features"><i class="fa fa-check"></i><b>8.3</b> Improving the features</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="conclusion.html"><a href="conclusion.html"><i class="fa fa-check"></i><b>9</b> Conclusion</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Dicours Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="topic-modelling" class="section level1">
<h1><span class="header-section-number">Chapter 6</span> Topic Modelling</h1>
<p>In this chapter, we analzye the topics of the speechs of Boris Jonhson and Macron using
- LSA(Latent Semantic analysis). The core idea is to take a matrix of what we have — documents and terms — and decompose it into a separate document-topic matrix and a topic-term matrix.</p>
<ul>
<li>LDA(Latent Dirichlet Allocation).It uses dirichlet priors for the document-topic and word-topic distributions, lending itself to better generalization.</li>
</ul>
<div id="boris-johnson-7" class="section level2">
<h2><span class="header-section-number">6.1</span> Boris Johnson</h2>
<div id="lsa" class="section level3">
<h3><span class="header-section-number">6.1.1</span> LSA</h3>
<p>First, we make the DTM matrix. We are goin to use 3 dimensions, it means 3 differents topics.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" data-line-number="1">bmod&lt;-<span class="kw">textmodel_lsa</span>(corpus_boris.dfm,<span class="dt">nd=</span><span class="dv">3</span>)</a></code></pre></div>
<p>To inspect the results, we can extract the matrices involved in the LSA decomposition.
In the firs table, each components measures the link between the document and the topic.
In the second table, each component measure the link between the document and the term.</p>
<p>LSA is typical a reduction technique. Insetead of have N documents or M term, it is represented by K documents.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" data-line-number="1">p1&lt;-<span class="kw">head</span>(bmod<span class="op">$</span>docs)</a>
<a class="sourceLine" id="cb29-2" data-line-number="2"></a>
<a class="sourceLine" id="cb29-3" data-line-number="3">p2&lt;-<span class="kw">head</span>(bmod<span class="op">$</span>features)</a>
<a class="sourceLine" id="cb29-4" data-line-number="4"></a>
<a class="sourceLine" id="cb29-5" data-line-number="5">p1<span class="op">/</span>p2</a></code></pre></div>
<table>
<tbody>
<tr>
<td style="text-align:left;">
text1
</td>
<td style="text-align:right;">
76.84
</td>
<td style="text-align:right;">
29.30
</td>
<td style="text-align:right;">
28.31
</td>
</tr>
<tr>
<td style="text-align:left;">
text2
</td>
<td style="text-align:right;">
45.86
</td>
<td style="text-align:right;">
9.62
</td>
<td style="text-align:right;">
20.76
</td>
</tr>
<tr>
<td style="text-align:left;">
text3
</td>
<td style="text-align:right;">
51.61
</td>
<td style="text-align:right;">
31.59
</td>
<td style="text-align:right;">
-61.10
</td>
</tr>
<tr>
<td style="text-align:left;">
text4
</td>
<td style="text-align:right;">
17.58
</td>
<td style="text-align:right;">
-12.42
</td>
<td style="text-align:right;">
-30.74
</td>
</tr>
<tr>
<td style="text-align:left;">
text5
</td>
<td style="text-align:right;">
33.10
</td>
<td style="text-align:right;">
-58.33
</td>
<td style="text-align:right;">
-9.25
</td>
</tr>
<tr>
<td style="text-align:left;">
text6
</td>
<td style="text-align:right;">
7.55
</td>
<td style="text-align:right;">
-7.88
</td>
<td style="text-align:right;">
-8.59
</td>
</tr>
</tbody>
</table>
<p>Often the first dimension in LSA is associated with the document lenght. To see if it is true, we build a scatter-plot between the document lengt and Dimension 1.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" data-line-number="1">ns&lt;-<span class="kw">apply</span>(corpus_boris.dfm,<span class="dv">1</span>,sum) </a>
<a class="sourceLine" id="cb30-2" data-line-number="2"><span class="kw">plot</span>(ns<span class="op">~</span>bmod<span class="op">$</span>docs [,<span class="dv">1</span>])</a></code></pre></div>
<p><img src="Text-Mining_files/figure-html/unnamed-chunk-245-1.png" width="70%" style="display: block; margin: auto;" />
We clearly observe that the dimension 1 is negatively correlated with the document lenght.</p>
<p>Now in order to make the link between the topics and the documents and the topics with term, we use biplot. We represent the dimension 2 ans 3, beacause often the first component bring often little information.</p>
<p>Reminders:</p>
<p>The seven speech are class by chronological order:
* 09 March (text1)
* 12 March (text2)
* 16 March (text3)
* 18 March (text5)
* 19 March (text6)
* 20 March (text7)
* 22 March (text8)</p>
<p>It is noticeable that the texts that are brought together over time are grouped together.And that the first speeches are the opposite of the last ones.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" data-line-number="1"><span class="kw">biplot</span>(<span class="dt">y=</span>bmod<span class="op">$</span>docs[,<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>],<span class="dt">x=</span>bmod<span class="op">$</span>features[,<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>],</a>
<a class="sourceLine" id="cb31-2" data-line-number="2">       <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;grey&quot;</span>,<span class="st">&quot;red&quot;</span>),</a>
<a class="sourceLine" id="cb31-3" data-line-number="3">       <span class="dt">xlab =</span> <span class="st">&quot;Dimension 2&quot;</span>,</a>
<a class="sourceLine" id="cb31-4" data-line-number="4">       <span class="dt">ylab=</span><span class="st">&quot;Dimension 3&quot;</span>)</a></code></pre></div>
<p><img src="Text-Mining_files/figure-html/unnamed-chunk-246-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>We repeat the same analysis with TF-IDF. The influence of small weighted-frequent tokens is reduced.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" data-line-number="1">bmod_<span class="dv">2</span>&lt;-<span class="st"> </span><span class="kw">textmodel_lsa</span>(corpus_boris.tfidf, <span class="dt">nd=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb32-2" data-line-number="2"></a>
<a class="sourceLine" id="cb32-3" data-line-number="3"><span class="kw">head</span>(bmod_<span class="dv">2</span><span class="op">$</span>docs)</a></code></pre></div>
<table>
<tbody>
<tr>
<td style="text-align:left;">
text1
</td>
<td style="text-align:right;">
-0.147
</td>
<td style="text-align:right;">
-0.063
</td>
<td style="text-align:right;">
-0.318
</td>
</tr>
<tr>
<td style="text-align:left;">
text2
</td>
<td style="text-align:right;">
-0.380
</td>
<td style="text-align:right;">
-0.187
</td>
<td style="text-align:right;">
-0.752
</td>
</tr>
<tr>
<td style="text-align:left;">
text3
</td>
<td style="text-align:right;">
-0.444
</td>
<td style="text-align:right;">
-0.750
</td>
<td style="text-align:right;">
0.463
</td>
</tr>
<tr>
<td style="text-align:left;">
text4
</td>
<td style="text-align:right;">
-0.735
</td>
<td style="text-align:right;">
0.615
</td>
<td style="text-align:right;">
0.256
</td>
</tr>
<tr>
<td style="text-align:left;">
text5
</td>
<td style="text-align:right;">
-0.180
</td>
<td style="text-align:right;">
-0.132
</td>
<td style="text-align:right;">
-0.173
</td>
</tr>
<tr>
<td style="text-align:left;">
text6
</td>
<td style="text-align:right;">
-0.200
</td>
<td style="text-align:right;">
-0.040
</td>
<td style="text-align:right;">
-0.153
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" data-line-number="1"></a>
<a class="sourceLine" id="cb33-2" data-line-number="2"><span class="kw">head</span>(bmod_<span class="dv">2</span><span class="op">$</span>features)</a></code></pre></div>
<table>
<tbody>
<tr>
<td style="text-align:left;">
morning
</td>
<td style="text-align:right;">
-0.008
</td>
<td style="text-align:right;">
-0.004
</td>
<td style="text-align:right;">
-0.025
</td>
</tr>
<tr>
<td style="text-align:left;">
government’s
</td>
<td style="text-align:right;">
-0.024
</td>
<td style="text-align:right;">
-0.014
</td>
<td style="text-align:right;">
-0.070
</td>
</tr>
<tr>
<td style="text-align:left;">
cobr
</td>
<td style="text-align:right;">
-0.021
</td>
<td style="text-align:right;">
-0.037
</td>
<td style="text-align:right;">
0.007
</td>
</tr>
<tr>
<td style="text-align:left;">
emergency
</td>
<td style="text-align:right;">
-0.042
</td>
<td style="text-align:right;">
-0.038
</td>
<td style="text-align:right;">
0.013
</td>
</tr>
<tr>
<td style="text-align:left;">
committee
</td>
<td style="text-align:right;">
-0.019
</td>
<td style="text-align:right;">
-0.011
</td>
<td style="text-align:right;">
-0.054
</td>
</tr>
<tr>
<td style="text-align:left;">
coronavirus
</td>
<td style="text-align:right;">
-0.016
</td>
<td style="text-align:right;">
-0.001
</td>
<td style="text-align:right;">
-0.011
</td>
</tr>
</tbody>
</table>
</div>
<div id="lda" class="section level3">
<h3><span class="header-section-number">6.1.2</span> LDA</h3>
<p>We now turn to the LDA. For illustration, we will make K=3 topis.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" data-line-number="1">K&lt;-<span class="dv">3</span></a>
<a class="sourceLine" id="cb34-2" data-line-number="2">corpus_boris.dtm&lt;-<span class="st"> </span><span class="kw">convert</span>(corpus_boris.dfm, <span class="dt">to=</span><span class="st">&quot;topicmodels&quot;</span>)</a>
<a class="sourceLine" id="cb34-3" data-line-number="3">lda_boris&lt;-<span class="st"> </span><span class="kw">LDA</span>(corpus_boris.dtm ,<span class="dt">k=</span>K)</a></code></pre></div>
<p>Top terms per topic and top topic per document can be easily obtained. Belo, the six top terms and the top topic are extracted.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" data-line-number="1"><span class="kw">terms</span>(lda_boris,<span class="dv">6</span>)</a></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
Topic 1
</th>
<th style="text-align:left;">
Topic 2
</th>
<th style="text-align:left;">
Topic 3
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
will
</td>
<td style="text-align:left;">
will
</td>
<td style="text-align:left;">
will
</td>
</tr>
<tr>
<td style="text-align:left;">
go
</td>
<td style="text-align:left;">
now
</td>
<td style="text-align:left;">
want
</td>
</tr>
<tr>
<td style="text-align:left;">
want
</td>
<td style="text-align:left;">
much
</td>
<td style="text-align:left;">
much
</td>
</tr>
<tr>
<td style="text-align:left;">
make
</td>
<td style="text-align:left;">
people
</td>
<td style="text-align:left;">
can
</td>
</tr>
<tr>
<td style="text-align:left;">
already
</td>
<td style="text-align:left;">
can
</td>
<td style="text-align:left;">
thank
</td>
</tr>
<tr>
<td style="text-align:left;">
know
</td>
<td style="text-align:left;">
go
</td>
<td style="text-align:left;">
measure
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" data-line-number="1"></a>
<a class="sourceLine" id="cb36-2" data-line-number="2"><span class="kw">topics</span>(lda_boris,<span class="dv">1</span>)  <span class="co">## To see the topics related to each document</span></a>
<a class="sourceLine" id="cb36-3" data-line-number="3"><span class="co">#&gt; text1 text2 text3 text4 text5 text6 text7 </span></a>
<a class="sourceLine" id="cb36-4" data-line-number="4"><span class="co">#&gt;     3     2     2     1     1     2     3</span></a></code></pre></div>
<p>We now build the bar plot to inspect the per-topic-per-word probabilities (beta’s). We take the 10 top terms and rearrange the beta per topic according to this order.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" data-line-number="1">beta.td.boris&lt;-<span class="kw">tidy</span>(lda_boris,<span class="dt">matrix=</span><span class="st">&quot;beta&quot;</span>)</a>
<a class="sourceLine" id="cb37-2" data-line-number="2"></a>
<a class="sourceLine" id="cb37-3" data-line-number="3">beta.top.term.boris&lt;-beta.td.boris <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb37-4" data-line-number="4"><span class="st">  </span><span class="kw">group_by</span>(topic) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb37-5" data-line-number="5"><span class="st">  </span><span class="kw">top_n</span>(<span class="dv">10</span>, beta) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb37-6" data-line-number="6"><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb37-7" data-line-number="7"><span class="st">  </span><span class="kw">arrange</span>(topic, <span class="op">-</span>beta)</a>
<a class="sourceLine" id="cb37-8" data-line-number="8"></a>
<a class="sourceLine" id="cb37-9" data-line-number="9"></a>
<a class="sourceLine" id="cb37-10" data-line-number="10">beta.top.term.boris <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb37-11" data-line-number="11"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">term=</span><span class="kw">reorder_within</span>(term, beta, topic)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb37-12" data-line-number="12"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(term,beta,<span class="dt">fill=</span><span class="kw">factor</span>(topic))) <span class="op">+</span></a>
<a class="sourceLine" id="cb37-13" data-line-number="13"><span class="st">   </span><span class="kw">geom_col</span>(<span class="dt">show.legend =</span> <span class="ot">FALSE</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb37-14" data-line-number="14"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>topic, <span class="dt">scales =</span> <span class="st">&quot;free&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb37-15" data-line-number="15"><span class="st">  </span><span class="kw">coord_flip</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb37-16" data-line-number="16"><span class="st">  </span><span class="kw">scale_x_reordered</span>()</a></code></pre></div>
<p><img src="Text-Mining_files/figure-html/unnamed-chunk-250-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Now, we compute the gamma, it shows the proportion of each topic within each document.
In the below figure, we note that each document represented a text.The texts are very distinctive.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" data-line-number="1">gamma.td.boris&lt;-<span class="st"> </span><span class="kw">tidy</span>(lda_boris,<span class="dt">matrix=</span><span class="st">&quot;gamma&quot;</span>)</a>
<a class="sourceLine" id="cb38-2" data-line-number="2"></a>
<a class="sourceLine" id="cb38-3" data-line-number="3"></a>
<a class="sourceLine" id="cb38-4" data-line-number="4">gamma.td.boris <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb38-5" data-line-number="5"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(document,gamma,<span class="dt">fill=</span><span class="kw">factor</span>(topic))) <span class="op">+</span></a>
<a class="sourceLine" id="cb38-6" data-line-number="6"><span class="st">  </span><span class="kw">geom_col</span>(<span class="dt">show.legend =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb38-7" data-line-number="7"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>topic,<span class="dt">scales =</span> <span class="st">&quot;free&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb38-8" data-line-number="8"><span class="st">  </span><span class="kw">coord_flip</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb38-9" data-line-number="9"><span class="st">  </span><span class="kw">scale_x_reordered</span>()</a></code></pre></div>
<p><img src="Text-Mining_files/figure-html/unnamed-chunk-251-1.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="macron-1" class="section level2">
<h2><span class="header-section-number">6.2</span> Macron</h2>
<div id="lsa-1" class="section level3">
<h3><span class="header-section-number">6.2.1</span> LSA</h3>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" data-line-number="1">mmod&lt;-<span class="kw">textmodel_lsa</span>(corpus_macron.dfm,<span class="dt">nd=</span><span class="dv">3</span>)</a></code></pre></div>
<p>To inspect the results, we can extract the matrices involved in the LSA decomposition</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" data-line-number="1"><span class="kw">head</span>(mmod<span class="op">$</span>docs)</a></code></pre></div>
<table>
<tbody>
<tr>
<td style="text-align:left;">
text1
</td>
<td style="text-align:right;">
-0.666
</td>
<td style="text-align:right;">
0.502
</td>
<td style="text-align:right;">
0.552
</td>
</tr>
<tr>
<td style="text-align:left;">
text2
</td>
<td style="text-align:right;">
-0.426
</td>
<td style="text-align:right;">
0.351
</td>
<td style="text-align:right;">
-0.834
</td>
</tr>
<tr>
<td style="text-align:left;">
text3
</td>
<td style="text-align:right;">
-0.612
</td>
<td style="text-align:right;">
-0.791
</td>
<td style="text-align:right;">
-0.020
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" data-line-number="1"></a>
<a class="sourceLine" id="cb41-2" data-line-number="2"><span class="kw">head</span>(mmod<span class="op">$</span>features)</a></code></pre></div>
<table>
<tbody>
<tr>
<td style="text-align:left;">
france
</td>
<td style="text-align:right;">
-0.080
</td>
<td style="text-align:right;">
0.032
</td>
<td style="text-align:right;">
0.009
</td>
</tr>
<tr>
<td style="text-align:left;">
dear
</td>
<td style="text-align:right;">
-0.054
</td>
<td style="text-align:right;">
0.016
</td>
<td style="text-align:right;">
-0.022
</td>
</tr>
<tr>
<td style="text-align:left;">
past
</td>
<td style="text-align:right;">
-0.023
</td>
<td style="text-align:right;">
-0.017
</td>
<td style="text-align:right;">
0.037
</td>
</tr>
<tr>
<td style="text-align:left;">
country
</td>
<td style="text-align:right;">
-0.075
</td>
<td style="text-align:right;">
-0.107
</td>
<td style="text-align:right;">
-0.071
</td>
</tr>
<tr>
<td style="text-align:left;">
spread
</td>
<td style="text-align:right;">
-0.049
</td>
<td style="text-align:right;">
0.077
</td>
<td style="text-align:right;">
0.024
</td>
</tr>
<tr>
<td style="text-align:left;">
virus
</td>
<td style="text-align:right;">
-0.101
</td>
<td style="text-align:right;">
-0.015
</td>
<td style="text-align:right;">
0.085
</td>
</tr>
</tbody>
</table>
<p>Often the first dimension in LSA is associated with the document lenght. To see if it is true, we build a scatter-plot between the document lengt and Dimension 1.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" data-line-number="1">ns_macron&lt;-<span class="kw">apply</span>(corpus_macron.dfm,<span class="dv">1</span>,sum) </a>
<a class="sourceLine" id="cb42-2" data-line-number="2"><span class="kw">plot</span>(ns_macron<span class="op">~</span>mmod<span class="op">$</span>docs [,<span class="dv">1</span>])</a></code></pre></div>
<p><img src="Text-Mining_files/figure-html/unnamed-chunk-254-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>We clearly observe that the dimension 1 is negatively correlated with the document lenght.</p>
<p>Now in order to make the link between the topics and the documents and the topics with term, we use biplot</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" data-line-number="1"><span class="kw">biplot</span>(<span class="dt">y=</span>mmod<span class="op">$</span>docs[,<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>],<span class="dt">x=</span>mmod<span class="op">$</span>features[,<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>],</a>
<a class="sourceLine" id="cb43-2" data-line-number="2">       <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;grey&quot;</span>,<span class="st">&quot;red&quot;</span>),</a>
<a class="sourceLine" id="cb43-3" data-line-number="3">       <span class="dt">xlab =</span> <span class="st">&quot;Dimension 2&quot;</span>,</a>
<a class="sourceLine" id="cb43-4" data-line-number="4">       <span class="dt">ylab=</span><span class="st">&quot;Dimension 3&quot;</span>)</a></code></pre></div>
<p><img src="Text-Mining_files/figure-html/unnamed-chunk-255-1.png" width="70%" style="display: block; margin: auto;" />
We repeat the same analysis with TF-IDF</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" data-line-number="1">mmod_<span class="dv">2</span>&lt;-<span class="st"> </span><span class="kw">textmodel_lsa</span>(corpus_macron.tfidf, <span class="dt">nd=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb44-2" data-line-number="2"></a>
<a class="sourceLine" id="cb44-3" data-line-number="3"><span class="kw">head</span>(mmod_<span class="dv">2</span><span class="op">$</span>docs)</a></code></pre></div>
<table>
<tbody>
<tr>
<td style="text-align:left;">
text1
</td>
<td style="text-align:right;">
-0.244
</td>
<td style="text-align:right;">
0.921
</td>
<td style="text-align:right;">
0.304
</td>
</tr>
<tr>
<td style="text-align:left;">
text2
</td>
<td style="text-align:right;">
-0.107
</td>
<td style="text-align:right;">
0.286
</td>
<td style="text-align:right;">
-0.952
</td>
</tr>
<tr>
<td style="text-align:left;">
text3
</td>
<td style="text-align:right;">
-0.964
</td>
<td style="text-align:right;">
-0.265
</td>
<td style="text-align:right;">
0.028
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" data-line-number="1"></a>
<a class="sourceLine" id="cb45-2" data-line-number="2"><span class="kw">head</span>(mmod_<span class="dv">2</span><span class="op">$</span>features)</a></code></pre></div>
<table>
<tbody>
<tr>
<td style="text-align:left;">
france
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;">
dear
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;">
past
</td>
<td style="text-align:right;">
-0.042
</td>
<td style="text-align:right;">
0.028
</td>
<td style="text-align:right;">
0.016
</td>
</tr>
<tr>
<td style="text-align:left;">
country
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;">
spread
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;">
virus
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
</tbody>
</table>
</div>
<div id="lda-1" class="section level3">
<h3><span class="header-section-number">6.2.2</span> LDA</h3>
<p>We now turn to the LDA. For illustration, we will make K=5 topis.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" data-line-number="1">K&lt;-<span class="dv">5</span></a>
<a class="sourceLine" id="cb46-2" data-line-number="2">corpus_macron.dtm&lt;-<span class="st"> </span><span class="kw">convert</span>(corpus_macron.dfm, <span class="dt">to=</span><span class="st">&quot;topicmodels&quot;</span>)</a>
<a class="sourceLine" id="cb46-3" data-line-number="3">lda_macron&lt;-<span class="st"> </span><span class="kw">LDA</span>(corpus_macron.dtm ,<span class="dt">k=</span>K)</a></code></pre></div>
<p>Top terms per topic and top topic per document can be easily obtained. Belo, the six top terms and the top topic are extracted.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" data-line-number="1"><span class="kw">terms</span>(lda_macron,<span class="dv">6</span>)</a></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
Topic 1
</th>
<th style="text-align:left;">
Topic 2
</th>
<th style="text-align:left;">
Topic 3
</th>
<th style="text-align:left;">
Topic 4
</th>
<th style="text-align:left;">
Topic 5
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
will
</td>
<td style="text-align:left;">
will
</td>
<td style="text-align:left;">
will
</td>
<td style="text-align:left;">
will
</td>
<td style="text-align:left;">
much
</td>
</tr>
<tr>
<td style="text-align:left;">
even
</td>
<td style="text-align:left;">
much
</td>
<td style="text-align:left;">
also
</td>
<td style="text-align:left;">
also
</td>
<td style="text-align:left;">
will
</td>
</tr>
<tr>
<td style="text-align:left;">
health
</td>
<td style="text-align:left;">
can
</td>
<td style="text-align:left;">
much
</td>
<td style="text-align:left;">
must
</td>
<td style="text-align:left;">
day
</td>
</tr>
<tr>
<td style="text-align:left;">
can
</td>
<td style="text-align:left;">
continue
</td>
<td style="text-align:left;">
take
</td>
<td style="text-align:left;">
protect
</td>
<td style="text-align:left;">
can
</td>
</tr>
<tr>
<td style="text-align:left;">
care
</td>
<td style="text-align:left;">
must
</td>
<td style="text-align:left;">
virus
</td>
<td style="text-align:left;">
go
</td>
<td style="text-align:left;">
also
</td>
</tr>
<tr>
<td style="text-align:left;">
protect
</td>
<td style="text-align:left;">
come
</td>
<td style="text-align:left;">
european
</td>
<td style="text-align:left;">
one
</td>
<td style="text-align:left;">
us
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" data-line-number="1"></a>
<a class="sourceLine" id="cb48-2" data-line-number="2"><span class="kw">topics</span>(lda_macron,<span class="dv">1</span>)  <span class="co">## To see the topics related to each document</span></a>
<a class="sourceLine" id="cb48-3" data-line-number="3"><span class="co">#&gt; text1 text2 text3 </span></a>
<a class="sourceLine" id="cb48-4" data-line-number="4"><span class="co">#&gt;     3     4     2</span></a></code></pre></div>
<p>We now build the bar plot to inspect the per-topic-per-word probabilities (beta’s). We take the 10 top terms and rearrange the beta per topic according to this order.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" data-line-number="1"></a>
<a class="sourceLine" id="cb49-2" data-line-number="2">beta.td.macron&lt;-<span class="kw">tidy</span>(lda_macron,<span class="dt">matrix=</span><span class="st">&quot;beta&quot;</span>)</a>
<a class="sourceLine" id="cb49-3" data-line-number="3"></a>
<a class="sourceLine" id="cb49-4" data-line-number="4">beta.top.term.macron&lt;-beta.td.macron <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb49-5" data-line-number="5"><span class="st">  </span><span class="kw">group_by</span>(topic) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb49-6" data-line-number="6"><span class="st">  </span><span class="kw">top_n</span>(<span class="dv">10</span>, beta) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb49-7" data-line-number="7"><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb49-8" data-line-number="8"><span class="st">  </span><span class="kw">arrange</span>(topic, <span class="op">-</span>beta)</a>
<a class="sourceLine" id="cb49-9" data-line-number="9"></a>
<a class="sourceLine" id="cb49-10" data-line-number="10">beta.top.term.macron <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb49-11" data-line-number="11"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">term=</span><span class="kw">reorder_within</span>(term, beta, topic)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb49-12" data-line-number="12"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(term,beta,<span class="dt">fill=</span><span class="kw">factor</span>(topic))) <span class="op">+</span></a>
<a class="sourceLine" id="cb49-13" data-line-number="13"><span class="st">  </span><span class="kw">geom_col</span>(<span class="dt">show.legend =</span> <span class="ot">FALSE</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb49-14" data-line-number="14"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>topic, <span class="dt">scales =</span> <span class="st">&quot;free&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb49-15" data-line-number="15"><span class="st">  </span><span class="kw">coord_flip</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb49-16" data-line-number="16"><span class="st">  </span><span class="kw">scale_x_reordered</span>()</a></code></pre></div>
<p><img src="Text-Mining_files/figure-html/unnamed-chunk-259-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Now, we compute the gamma, it shows the proportion of each topic within each document. We note that text 1 is related to the topic 1 4 and 5. Th test 3 is related to the topic 2. And the text 2 is related to the topic 3.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" data-line-number="1">gamma.td.macron&lt;-<span class="st"> </span><span class="kw">tidy</span>(lda_macron,<span class="dt">matrix=</span><span class="st">&quot;gamma&quot;</span>)</a>
<a class="sourceLine" id="cb50-2" data-line-number="2"></a>
<a class="sourceLine" id="cb50-3" data-line-number="3">gamma.td.macron <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb50-4" data-line-number="4"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(document,gamma,<span class="dt">fill=</span><span class="kw">factor</span>(topic))) <span class="op">+</span></a>
<a class="sourceLine" id="cb50-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_col</span>(<span class="dt">show.legend =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb50-6" data-line-number="6"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>topic,<span class="dt">scales =</span> <span class="st">&quot;free&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb50-7" data-line-number="7"><span class="st">  </span><span class="kw">coord_flip</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb50-8" data-line-number="8"><span class="st">  </span><span class="kw">scale_x_reordered</span>()</a></code></pre></div>
<p><img src="Text-Mining_files/figure-html/unnamed-chunk-260-1.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="combine" class="section level2">
<h2><span class="header-section-number">6.3</span> Combine</h2>
<p>We combine the speeches of both author in a same dataframe and we divide the text into sentence to have a bigger dataframe.
Now we have 730 differents sentences.</p>
<div id="lsa-2" class="section level3">
<h3><span class="header-section-number">6.3.1</span> LSA</h3>
<p>Because of the huge number of tokens, the feature matrix hence obtained may be too big to train a model in a reasonable amount of time. We thus apply a reduction dimension technoque in order to obtain less feature but still kepp the relevant informations. LSA is perfect to this.
As a first trialm we target 30 dimensions ( 30 subjects)</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" data-line-number="1"></a>
<a class="sourceLine" id="cb51-2" data-line-number="2">combine_corpus.dfm &lt;-<span class="st"> </span><span class="kw">dfm</span>(combine_corpus)</a>
<a class="sourceLine" id="cb51-3" data-line-number="3">cmod&lt;-<span class="kw">textmodel_lsa</span>(combine_corpus.dfm,<span class="dt">nd=</span><span class="dv">30</span>)</a>
<a class="sourceLine" id="cb51-4" data-line-number="4"></a>
<a class="sourceLine" id="cb51-5" data-line-number="5"><span class="kw">head</span>(cmod<span class="op">$</span>docs)</a></code></pre></div>
<table>
<tbody>
<tr>
<td style="text-align:left;">
text1
</td>
<td style="text-align:right;">
-0.011
</td>
<td style="text-align:right;">
-0.007
</td>
<td style="text-align:right;">
-0.056
</td>
<td style="text-align:right;">
0.010
</td>
<td style="text-align:right;">
-0.002
</td>
<td style="text-align:right;">
-0.007
</td>
<td style="text-align:right;">
0.051
</td>
<td style="text-align:right;">
0.025
</td>
<td style="text-align:right;">
0.010
</td>
<td style="text-align:right;">
0.013
</td>
<td style="text-align:right;">
0.022
</td>
<td style="text-align:right;">
-0.001
</td>
<td style="text-align:right;">
0.018
</td>
<td style="text-align:right;">
-0.045
</td>
<td style="text-align:right;">
-0.051
</td>
<td style="text-align:right;">
0.006
</td>
<td style="text-align:right;">
0.041
</td>
<td style="text-align:right;">
0.019
</td>
<td style="text-align:right;">
0.039
</td>
<td style="text-align:right;">
-0.053
</td>
<td style="text-align:right;">
-0.015
</td>
<td style="text-align:right;">
0.004
</td>
<td style="text-align:right;">
-0.025
</td>
<td style="text-align:right;">
0.010
</td>
<td style="text-align:right;">
-0.029
</td>
<td style="text-align:right;">
0.009
</td>
<td style="text-align:right;">
0.032
</td>
<td style="text-align:right;">
0.002
</td>
<td style="text-align:right;">
-0.018
</td>
<td style="text-align:right;">
-0.009
</td>
</tr>
<tr>
<td style="text-align:left;">
text2
</td>
<td style="text-align:right;">
-0.033
</td>
<td style="text-align:right;">
-0.030
</td>
<td style="text-align:right;">
-0.068
</td>
<td style="text-align:right;">
-0.032
</td>
<td style="text-align:right;">
-0.051
</td>
<td style="text-align:right;">
0.145
</td>
<td style="text-align:right;">
-0.085
</td>
<td style="text-align:right;">
-0.043
</td>
<td style="text-align:right;">
0.037
</td>
<td style="text-align:right;">
-0.046
</td>
<td style="text-align:right;">
0.079
</td>
<td style="text-align:right;">
-0.026
</td>
<td style="text-align:right;">
-0.011
</td>
<td style="text-align:right;">
-0.056
</td>
<td style="text-align:right;">
-0.052
</td>
<td style="text-align:right;">
-0.020
</td>
<td style="text-align:right;">
0.006
</td>
<td style="text-align:right;">
-0.027
</td>
<td style="text-align:right;">
0.035
</td>
<td style="text-align:right;">
0.035
</td>
<td style="text-align:right;">
0.052
</td>
<td style="text-align:right;">
-0.061
</td>
<td style="text-align:right;">
-0.039
</td>
<td style="text-align:right;">
0.014
</td>
<td style="text-align:right;">
-0.007
</td>
<td style="text-align:right;">
0.004
</td>
<td style="text-align:right;">
-0.024
</td>
<td style="text-align:right;">
-0.051
</td>
<td style="text-align:right;">
0.089
</td>
<td style="text-align:right;">
0.037
</td>
</tr>
<tr>
<td style="text-align:left;">
text3
</td>
<td style="text-align:right;">
-0.012
</td>
<td style="text-align:right;">
-0.010
</td>
<td style="text-align:right;">
-0.045
</td>
<td style="text-align:right;">
0.005
</td>
<td style="text-align:right;">
-0.032
</td>
<td style="text-align:right;">
-0.020
</td>
<td style="text-align:right;">
-0.015
</td>
<td style="text-align:right;">
-0.011
</td>
<td style="text-align:right;">
0.035
</td>
<td style="text-align:right;">
-0.017
</td>
<td style="text-align:right;">
0.029
</td>
<td style="text-align:right;">
0.016
</td>
<td style="text-align:right;">
-0.026
</td>
<td style="text-align:right;">
-0.002
</td>
<td style="text-align:right;">
-0.035
</td>
<td style="text-align:right;">
-0.008
</td>
<td style="text-align:right;">
0.052
</td>
<td style="text-align:right;">
0.001
</td>
<td style="text-align:right;">
0.028
</td>
<td style="text-align:right;">
-0.023
</td>
<td style="text-align:right;">
0.010
</td>
<td style="text-align:right;">
-0.027
</td>
<td style="text-align:right;">
0.013
</td>
<td style="text-align:right;">
0.003
</td>
<td style="text-align:right;">
0.008
</td>
<td style="text-align:right;">
0.009
</td>
<td style="text-align:right;">
0.018
</td>
<td style="text-align:right;">
-0.031
</td>
<td style="text-align:right;">
0.037
</td>
<td style="text-align:right;">
-0.003
</td>
</tr>
<tr>
<td style="text-align:left;">
text4
</td>
<td style="text-align:right;">
-0.012
</td>
<td style="text-align:right;">
-0.006
</td>
<td style="text-align:right;">
0.004
</td>
<td style="text-align:right;">
-0.067
</td>
<td style="text-align:right;">
0.008
</td>
<td style="text-align:right;">
0.051
</td>
<td style="text-align:right;">
-0.017
</td>
<td style="text-align:right;">
-0.018
</td>
<td style="text-align:right;">
0.053
</td>
<td style="text-align:right;">
-0.007
</td>
<td style="text-align:right;">
0.023
</td>
<td style="text-align:right;">
-0.006
</td>
<td style="text-align:right;">
0.027
</td>
<td style="text-align:right;">
-0.025
</td>
<td style="text-align:right;">
-0.042
</td>
<td style="text-align:right;">
-0.015
</td>
<td style="text-align:right;">
0.009
</td>
<td style="text-align:right;">
-0.036
</td>
<td style="text-align:right;">
0.002
</td>
<td style="text-align:right;">
0.002
</td>
<td style="text-align:right;">
0.005
</td>
<td style="text-align:right;">
-0.031
</td>
<td style="text-align:right;">
-0.010
</td>
<td style="text-align:right;">
-0.007
</td>
<td style="text-align:right;">
0.004
</td>
<td style="text-align:right;">
0.014
</td>
<td style="text-align:right;">
-0.018
</td>
<td style="text-align:right;">
0.009
</td>
<td style="text-align:right;">
-0.001
</td>
<td style="text-align:right;">
0.007
</td>
</tr>
<tr>
<td style="text-align:left;">
text5
</td>
<td style="text-align:right;">
-0.016
</td>
<td style="text-align:right;">
0.020
</td>
<td style="text-align:right;">
-0.017
</td>
<td style="text-align:right;">
-0.010
</td>
<td style="text-align:right;">
-0.059
</td>
<td style="text-align:right;">
0.050
</td>
<td style="text-align:right;">
-0.004
</td>
<td style="text-align:right;">
-0.019
</td>
<td style="text-align:right;">
0.034
</td>
<td style="text-align:right;">
-0.054
</td>
<td style="text-align:right;">
-0.014
</td>
<td style="text-align:right;">
0.022
</td>
<td style="text-align:right;">
0.007
</td>
<td style="text-align:right;">
0.028
</td>
<td style="text-align:right;">
-0.008
</td>
<td style="text-align:right;">
-0.021
</td>
<td style="text-align:right;">
0.039
</td>
<td style="text-align:right;">
0.028
</td>
<td style="text-align:right;">
-0.085
</td>
<td style="text-align:right;">
0.012
</td>
<td style="text-align:right;">
-0.001
</td>
<td style="text-align:right;">
0.028
</td>
<td style="text-align:right;">
0.009
</td>
<td style="text-align:right;">
0.043
</td>
<td style="text-align:right;">
0.018
</td>
<td style="text-align:right;">
-0.006
</td>
<td style="text-align:right;">
-0.008
</td>
<td style="text-align:right;">
0.015
</td>
<td style="text-align:right;">
-0.005
</td>
<td style="text-align:right;">
-0.001
</td>
</tr>
<tr>
<td style="text-align:left;">
text6
</td>
<td style="text-align:right;">
-0.027
</td>
<td style="text-align:right;">
0.050
</td>
<td style="text-align:right;">
-0.022
</td>
<td style="text-align:right;">
0.013
</td>
<td style="text-align:right;">
0.004
</td>
<td style="text-align:right;">
0.033
</td>
<td style="text-align:right;">
-0.013
</td>
<td style="text-align:right;">
0.034
</td>
<td style="text-align:right;">
0.022
</td>
<td style="text-align:right;">
0.049
</td>
<td style="text-align:right;">
-0.039
</td>
<td style="text-align:right;">
0.058
</td>
<td style="text-align:right;">
-0.011
</td>
<td style="text-align:right;">
-0.019
</td>
<td style="text-align:right;">
0.042
</td>
<td style="text-align:right;">
-0.042
</td>
<td style="text-align:right;">
-0.003
</td>
<td style="text-align:right;">
0.027
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
-0.059
</td>
<td style="text-align:right;">
0.007
</td>
<td style="text-align:right;">
-0.014
</td>
<td style="text-align:right;">
-0.034
</td>
<td style="text-align:right;">
-0.016
</td>
<td style="text-align:right;">
0.014
</td>
<td style="text-align:right;">
0.016
</td>
<td style="text-align:right;">
0.003
</td>
<td style="text-align:right;">
0.007
</td>
<td style="text-align:right;">
0.025
</td>
<td style="text-align:right;">
-0.008
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" data-line-number="1"></a>
<a class="sourceLine" id="cb52-2" data-line-number="2"></a>
<a class="sourceLine" id="cb52-3" data-line-number="3">p3&lt;-<span class="kw">head</span>(cmod<span class="op">$</span>docs)</a>
<a class="sourceLine" id="cb52-4" data-line-number="4"></a>
<a class="sourceLine" id="cb52-5" data-line-number="5">p4&lt;-<span class="kw">head</span>(cmod<span class="op">$</span>features)</a>
<a class="sourceLine" id="cb52-6" data-line-number="6">p3<span class="op">/</span>p4</a></code></pre></div>
<table>
<tbody>
<tr>
<td style="text-align:left;">
text1
</td>
<td style="text-align:right;">
0.108
</td>
<td style="text-align:right;">
0.139
</td>
<td style="text-align:right;">
-1.725
</td>
<td style="text-align:right;">
-0.134
</td>
<td style="text-align:right;">
0.036
</td>
<td style="text-align:right;">
0.060
</td>
<td style="text-align:right;">
0.180
</td>
<td style="text-align:right;">
1.156
</td>
<td style="text-align:right;">
0.168
</td>
<td style="text-align:right;">
-0.261
</td>
<td style="text-align:right;">
-0.523
</td>
<td style="text-align:right;">
0.006
</td>
<td style="text-align:right;">
0.207
</td>
<td style="text-align:right;">
0.078
</td>
<td style="text-align:right;">
-1.034
</td>
<td style="text-align:right;">
0.019
</td>
<td style="text-align:right;">
-0.446
</td>
<td style="text-align:right;">
0.043
</td>
<td style="text-align:right;">
20.615
</td>
<td style="text-align:right;">
4.295
</td>
<td style="text-align:right;">
-0.289
</td>
<td style="text-align:right;">
0.058
</td>
<td style="text-align:right;">
2.184
</td>
<td style="text-align:right;">
2.488
</td>
<td style="text-align:right;">
0.222
</td>
<td style="text-align:right;">
-0.120
</td>
<td style="text-align:right;">
-1.576
</td>
<td style="text-align:right;">
0.034
</td>
<td style="text-align:right;">
-1.102
</td>
<td style="text-align:right;">
0.311
</td>
</tr>
<tr>
<td style="text-align:left;">
text2
</td>
<td style="text-align:right;">
61.628
</td>
<td style="text-align:right;">
-19.356
</td>
<td style="text-align:right;">
13.418
</td>
<td style="text-align:right;">
91.056
</td>
<td style="text-align:right;">
-39.826
</td>
<td style="text-align:right;">
-97.345
</td>
<td style="text-align:right;">
-17.921
</td>
<td style="text-align:right;">
-17.603
</td>
<td style="text-align:right;">
6.827
</td>
<td style="text-align:right;">
55.745
</td>
<td style="text-align:right;">
43.520
</td>
<td style="text-align:right;">
-72.088
</td>
<td style="text-align:right;">
-1.821
</td>
<td style="text-align:right;">
4.764
</td>
<td style="text-align:right;">
8.293
</td>
<td style="text-align:right;">
28.487
</td>
<td style="text-align:right;">
1.920
</td>
<td style="text-align:right;">
-2.599
</td>
<td style="text-align:right;">
3.618
</td>
<td style="text-align:right;">
-3.162
</td>
<td style="text-align:right;">
-22.008
</td>
<td style="text-align:right;">
-4.953
</td>
<td style="text-align:right;">
93.112
</td>
<td style="text-align:right;">
2.386
</td>
<td style="text-align:right;">
-4.987
</td>
<td style="text-align:right;">
0.487
</td>
<td style="text-align:right;">
-2.428
</td>
<td style="text-align:right;">
50.835
</td>
<td style="text-align:right;">
24.674
</td>
<td style="text-align:right;">
-3.929
</td>
</tr>
<tr>
<td style="text-align:left;">
text3
</td>
<td style="text-align:right;">
0.100
</td>
<td style="text-align:right;">
0.131
</td>
<td style="text-align:right;">
-0.642
</td>
<td style="text-align:right;">
-0.154
</td>
<td style="text-align:right;">
-0.417
</td>
<td style="text-align:right;">
-2.657
</td>
<td style="text-align:right;">
-0.050
</td>
<td style="text-align:right;">
-1.089
</td>
<td style="text-align:right;">
0.224
</td>
<td style="text-align:right;">
-0.164
</td>
<td style="text-align:right;">
3.800
</td>
<td style="text-align:right;">
0.088
</td>
<td style="text-align:right;">
-0.048
</td>
<td style="text-align:right;">
0.015
</td>
<td style="text-align:right;">
0.125
</td>
<td style="text-align:right;">
0.500
</td>
<td style="text-align:right;">
-0.779
</td>
<td style="text-align:right;">
-0.002
</td>
<td style="text-align:right;">
-10.854
</td>
<td style="text-align:right;">
0.129
</td>
<td style="text-align:right;">
-0.079
</td>
<td style="text-align:right;">
0.252
</td>
<td style="text-align:right;">
6.056
</td>
<td style="text-align:right;">
0.026
</td>
<td style="text-align:right;">
0.104
</td>
<td style="text-align:right;">
-0.164
</td>
<td style="text-align:right;">
-2.462
</td>
<td style="text-align:right;">
-0.359
</td>
<td style="text-align:right;">
0.429
</td>
<td style="text-align:right;">
-0.046
</td>
</tr>
<tr>
<td style="text-align:left;">
text4
</td>
<td style="text-align:right;">
70.242
</td>
<td style="text-align:right;">
-22.250
</td>
<td style="text-align:right;">
-1.809
</td>
<td style="text-align:right;">
-114.094
</td>
<td style="text-align:right;">
-8.222
</td>
<td style="text-align:right;">
65.161
</td>
<td style="text-align:right;">
-5.615
</td>
<td style="text-align:right;">
-8.608
</td>
<td style="text-align:right;">
144.372
</td>
<td style="text-align:right;">
-8.693
</td>
<td style="text-align:right;">
6.049
</td>
<td style="text-align:right;">
6.212
</td>
<td style="text-align:right;">
-54.109
</td>
<td style="text-align:right;">
7.590
</td>
<td style="text-align:right;">
6.132
</td>
<td style="text-align:right;">
53.170
</td>
<td style="text-align:right;">
1.385
</td>
<td style="text-align:right;">
-14.945
</td>
<td style="text-align:right;">
0.482
</td>
<td style="text-align:right;">
-0.341
</td>
<td style="text-align:right;">
9.504
</td>
<td style="text-align:right;">
15.850
</td>
<td style="text-align:right;">
6.370
</td>
<td style="text-align:right;">
10.239
</td>
<td style="text-align:right;">
-1.625
</td>
<td style="text-align:right;">
9.331
</td>
<td style="text-align:right;">
-4.553
</td>
<td style="text-align:right;">
-5.847
</td>
<td style="text-align:right;">
13.087
</td>
<td style="text-align:right;">
-5.774
</td>
</tr>
<tr>
<td style="text-align:left;">
text5
</td>
<td style="text-align:right;">
0.170
</td>
<td style="text-align:right;">
-0.360
</td>
<td style="text-align:right;">
-0.277
</td>
<td style="text-align:right;">
0.299
</td>
<td style="text-align:right;">
1.991
</td>
<td style="text-align:right;">
-0.787
</td>
<td style="text-align:right;">
-0.024
</td>
<td style="text-align:right;">
-0.384
</td>
<td style="text-align:right;">
-0.165
</td>
<td style="text-align:right;">
0.989
</td>
<td style="text-align:right;">
-0.246
</td>
<td style="text-align:right;">
0.177
</td>
<td style="text-align:right;">
-0.025
</td>
<td style="text-align:right;">
2.730
</td>
<td style="text-align:right;">
0.019
</td>
<td style="text-align:right;">
-0.218
</td>
<td style="text-align:right;">
0.081
</td>
<td style="text-align:right;">
0.268
</td>
<td style="text-align:right;">
-0.846
</td>
<td style="text-align:right;">
-0.040
</td>
<td style="text-align:right;">
0.008
</td>
<td style="text-align:right;">
-0.353
</td>
<td style="text-align:right;">
0.091
</td>
<td style="text-align:right;">
-0.533
</td>
<td style="text-align:right;">
0.380
</td>
<td style="text-align:right;">
-0.058
</td>
<td style="text-align:right;">
-0.763
</td>
<td style="text-align:right;">
-0.086
</td>
<td style="text-align:right;">
-0.169
</td>
<td style="text-align:right;">
0.012
</td>
</tr>
<tr>
<td style="text-align:left;">
text6
</td>
<td style="text-align:right;">
37.024
</td>
<td style="text-align:right;">
11.208
</td>
<td style="text-align:right;">
-24.183
</td>
<td style="text-align:right;">
-10.497
</td>
<td style="text-align:right;">
0.904
</td>
<td style="text-align:right;">
24.420
</td>
<td style="text-align:right;">
11.907
</td>
<td style="text-align:right;">
5.668
</td>
<td style="text-align:right;">
-4.519
</td>
<td style="text-align:right;">
-12.691
</td>
<td style="text-align:right;">
-4.510
</td>
<td style="text-align:right;">
-7.907
</td>
<td style="text-align:right;">
0.997
</td>
<td style="text-align:right;">
7.654
</td>
<td style="text-align:right;">
-3.543
</td>
<td style="text-align:right;">
10.034
</td>
<td style="text-align:right;">
-0.352
</td>
<td style="text-align:right;">
15.011
</td>
<td style="text-align:right;">
-0.003
</td>
<td style="text-align:right;">
5.417
</td>
<td style="text-align:right;">
0.773
</td>
<td style="text-align:right;">
1.085
</td>
<td style="text-align:right;">
5.852
</td>
<td style="text-align:right;">
-1.202
</td>
<td style="text-align:right;">
5.149
</td>
<td style="text-align:right;">
0.939
</td>
<td style="text-align:right;">
0.449
</td>
<td style="text-align:right;">
0.399
</td>
<td style="text-align:right;">
0.752
</td>
<td style="text-align:right;">
-2.224
</td>
</tr>
</tbody>
</table>
<p>Often the first dimension in LSA is associated with the document lenght. To see if it is true, we build a scatter-plot between the document lengt and Dimension 1.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" data-line-number="1">ns_combine&lt;-<span class="kw">apply</span>(combine_corpus.dfm,<span class="dv">1</span>,sum) </a>
<a class="sourceLine" id="cb53-2" data-line-number="2"><span class="kw">plot</span>(ns_combine<span class="op">~</span>cmod<span class="op">$</span>docs [,<span class="dv">1</span>])</a></code></pre></div>
<p><img src="Text-Mining_files/figure-html/unnamed-chunk-263-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" data-line-number="1"><span class="kw">biplot</span>(<span class="dt">y=</span>cmod<span class="op">$</span>docs[,<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>],<span class="dt">x=</span>cmod<span class="op">$</span>features[,<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>],</a>
<a class="sourceLine" id="cb54-2" data-line-number="2">       <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;grey&quot;</span>,<span class="st">&quot;red&quot;</span>),</a>
<a class="sourceLine" id="cb54-3" data-line-number="3">       <span class="dt">xlab =</span> <span class="st">&quot;Dimension 2&quot;</span>,</a>
<a class="sourceLine" id="cb54-4" data-line-number="4">       <span class="dt">ylab=</span><span class="st">&quot;Dimension 3&quot;</span>)</a></code></pre></div>
<p><img src="Text-Mining_files/figure-html/unnamed-chunk-264-1.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="lda-2" class="section level3">
<h3><span class="header-section-number">6.3.2</span> LDA</h3>
<p>We now turn to the LDA. For illustration, we will make K=3 topis.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" data-line-number="1">K&lt;-<span class="dv">3</span></a>
<a class="sourceLine" id="cb55-2" data-line-number="2">combine_corpus.dtm&lt;-<span class="st"> </span><span class="kw">convert</span>(combine_corpus.dfm, <span class="dt">to=</span><span class="st">&quot;topicmodels&quot;</span>)</a>
<a class="sourceLine" id="cb55-3" data-line-number="3">lda_combine&lt;-<span class="st"> </span><span class="kw">LDA</span>(combine_corpus.dtm ,<span class="dt">k=</span>K)</a></code></pre></div>
<p>Top terms per topic and top topic per document can be easily obtained. Belo, the six top terms and the top topic are extracted.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb56-1" data-line-number="1"><span class="kw">terms</span>(lda_combine,<span class="dv">6</span>)</a></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
Topic 1
</th>
<th style="text-align:left;">
Topic 2
</th>
<th style="text-align:left;">
Topic 3
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
,
</td>
<td style="text-align:left;">
,
</td>
<td style="text-align:left;">
.
</td>
</tr>
<tr>
<td style="text-align:left;">
the
</td>
<td style="text-align:left;">
to
</td>
<td style="text-align:left;">
,
</td>
</tr>
<tr>
<td style="text-align:left;">
to
</td>
<td style="text-align:left;">
the
</td>
<td style="text-align:left;">
the
</td>
</tr>
<tr>
<td style="text-align:left;">
.
</td>
<td style="text-align:left;">
and
</td>
<td style="text-align:left;">
and
</td>
</tr>
<tr>
<td style="text-align:left;">
and
</td>
<td style="text-align:left;">
.
</td>
<td style="text-align:left;">
of
</td>
</tr>
<tr>
<td style="text-align:left;">
will
</td>
<td style="text-align:left;">
we
</td>
<td style="text-align:left;">
we
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" data-line-number="1"></a>
<a class="sourceLine" id="cb57-2" data-line-number="2"><span class="kw">topics</span>(lda_combine,<span class="dv">1</span>)  <span class="co">## To see the topics related to each document</span></a>
<a class="sourceLine" id="cb57-3" data-line-number="3"><span class="co">#&gt;   text1   text2   text3   text4   text5   text6   text7   text8 </span></a>
<a class="sourceLine" id="cb57-4" data-line-number="4"><span class="co">#&gt;       3       3       3       2       3       1       2       2 </span></a>
<a class="sourceLine" id="cb57-5" data-line-number="5"><span class="co">#&gt;   text9  text10  text11  text12  text13  text14  text15  text16 </span></a>
<a class="sourceLine" id="cb57-6" data-line-number="6"><span class="co">#&gt;       2       2       3       2       2       3       1       1 </span></a>
<a class="sourceLine" id="cb57-7" data-line-number="7"><span class="co">#&gt;  text17  text18  text19  text20  text21  text22  text23  text24 </span></a>
<a class="sourceLine" id="cb57-8" data-line-number="8"><span class="co">#&gt;       3       3       1       2       2       2       3       3 </span></a>
<a class="sourceLine" id="cb57-9" data-line-number="9"><span class="co">#&gt;  text25  text26  text27  text28  text29  text30  text31  text32 </span></a>
<a class="sourceLine" id="cb57-10" data-line-number="10"><span class="co">#&gt;       2       2       3       2       1       3       3       3 </span></a>
<a class="sourceLine" id="cb57-11" data-line-number="11"><span class="co">#&gt;  text33  text34  text35  text36  text37  text38  text39  text40 </span></a>
<a class="sourceLine" id="cb57-12" data-line-number="12"><span class="co">#&gt;       3       2       2       2       3       2       3       3 </span></a>
<a class="sourceLine" id="cb57-13" data-line-number="13"><span class="co">#&gt;  text41  text42  text43  text44  text45  text46  text47  text48 </span></a>
<a class="sourceLine" id="cb57-14" data-line-number="14"><span class="co">#&gt;       1       3       3       2       2       2       2       3 </span></a>
<a class="sourceLine" id="cb57-15" data-line-number="15"><span class="co">#&gt;  text49  text50  text51  text52  text53  text54  text55  text56 </span></a>
<a class="sourceLine" id="cb57-16" data-line-number="16"><span class="co">#&gt;       2       3       3       2       3       2       2       3 </span></a>
<a class="sourceLine" id="cb57-17" data-line-number="17"><span class="co">#&gt;  text57  text58  text59  text60  text61  text62  text63  text64 </span></a>
<a class="sourceLine" id="cb57-18" data-line-number="18"><span class="co">#&gt;       3       3       2       1       2       2       2       2 </span></a>
<a class="sourceLine" id="cb57-19" data-line-number="19"><span class="co">#&gt;  text65  text66  text67  text68  text69  text70  text71  text72 </span></a>
<a class="sourceLine" id="cb57-20" data-line-number="20"><span class="co">#&gt;       1       2       1       2       2       2       2       2 </span></a>
<a class="sourceLine" id="cb57-21" data-line-number="21"><span class="co">#&gt;  text73  text74  text75  text76  text77  text78  text79  text80 </span></a>
<a class="sourceLine" id="cb57-22" data-line-number="22"><span class="co">#&gt;       2       2       2       3       3       2       3       1 </span></a>
<a class="sourceLine" id="cb57-23" data-line-number="23"><span class="co">#&gt;  text81  text82  text83  text84  text85  text86  text87  text88 </span></a>
<a class="sourceLine" id="cb57-24" data-line-number="24"><span class="co">#&gt;       2       2       3       2       2       2       2       2 </span></a>
<a class="sourceLine" id="cb57-25" data-line-number="25"><span class="co">#&gt;  text89  text90  text91  text92  text93  text94  text95  text96 </span></a>
<a class="sourceLine" id="cb57-26" data-line-number="26"><span class="co">#&gt;       2       3       2       2       1       1       2       3 </span></a>
<a class="sourceLine" id="cb57-27" data-line-number="27"><span class="co">#&gt;  text97  text98  text99 text100 text101 text102 text103 text104 </span></a>
<a class="sourceLine" id="cb57-28" data-line-number="28"><span class="co">#&gt;       3       3       2       3       2       1       1       1 </span></a>
<a class="sourceLine" id="cb57-29" data-line-number="29"><span class="co">#&gt; text105 text106 text107 text108 text109 text110 text111 text112 </span></a>
<a class="sourceLine" id="cb57-30" data-line-number="30"><span class="co">#&gt;       2       2       2       2       2       2       3       2 </span></a>
<a class="sourceLine" id="cb57-31" data-line-number="31"><span class="co">#&gt; text113 text114 text115 text116 text117 text118 text119 text120 </span></a>
<a class="sourceLine" id="cb57-32" data-line-number="32"><span class="co">#&gt;       2       3       2       2       3       2       1       2 </span></a>
<a class="sourceLine" id="cb57-33" data-line-number="33"><span class="co">#&gt; text121 text122 text123 text124 text125 text126 text127 text128 </span></a>
<a class="sourceLine" id="cb57-34" data-line-number="34"><span class="co">#&gt;       2       2       2       2       3       2       2       2 </span></a>
<a class="sourceLine" id="cb57-35" data-line-number="35"><span class="co">#&gt; text129 text130 text131 text132 text133 text134 text135 text136 </span></a>
<a class="sourceLine" id="cb57-36" data-line-number="36"><span class="co">#&gt;       3       3       3       2       2       2       3       1 </span></a>
<a class="sourceLine" id="cb57-37" data-line-number="37"><span class="co">#&gt; text137 text138 text139 text140 text141 text142 text143 text144 </span></a>
<a class="sourceLine" id="cb57-38" data-line-number="38"><span class="co">#&gt;       1       2       2       1       1       1       1       1 </span></a>
<a class="sourceLine" id="cb57-39" data-line-number="39"><span class="co">#&gt; text145 text146 text147 text148 text149 text150 text151 text152 </span></a>
<a class="sourceLine" id="cb57-40" data-line-number="40"><span class="co">#&gt;       1       2       2       3       2       1       2       1 </span></a>
<a class="sourceLine" id="cb57-41" data-line-number="41"><span class="co">#&gt; text153 text154 text155 text156 text157 text158 text159 text160 </span></a>
<a class="sourceLine" id="cb57-42" data-line-number="42"><span class="co">#&gt;       1       2       1       2       2       1       3       2 </span></a>
<a class="sourceLine" id="cb57-43" data-line-number="43"><span class="co">#&gt; text161 text162 text163 text164 text165 text166 text167 text168 </span></a>
<a class="sourceLine" id="cb57-44" data-line-number="44"><span class="co">#&gt;       2       3       2       2       3       2       2       2 </span></a>
<a class="sourceLine" id="cb57-45" data-line-number="45"><span class="co">#&gt; text169 text170 text171 text172 text173 text174 text175 text176 </span></a>
<a class="sourceLine" id="cb57-46" data-line-number="46"><span class="co">#&gt;       2       2       2       2       2       2       2       2 </span></a>
<a class="sourceLine" id="cb57-47" data-line-number="47"><span class="co">#&gt; text177 text178 text179 text180 text181 text182 text183 text184 </span></a>
<a class="sourceLine" id="cb57-48" data-line-number="48"><span class="co">#&gt;       2       2       1       2       1       3       2       2 </span></a>
<a class="sourceLine" id="cb57-49" data-line-number="49"><span class="co">#&gt; text185 text186 text187 text188 text189 text190 text191 text192 </span></a>
<a class="sourceLine" id="cb57-50" data-line-number="50"><span class="co">#&gt;       2       2       2       2       2       2       2       3 </span></a>
<a class="sourceLine" id="cb57-51" data-line-number="51"><span class="co">#&gt; text193 text194 text195 text196 text197 text198 text199 text200 </span></a>
<a class="sourceLine" id="cb57-52" data-line-number="52"><span class="co">#&gt;       3       1       3       3       2       2       2       2 </span></a>
<a class="sourceLine" id="cb57-53" data-line-number="53"><span class="co">#&gt; text201 text202 text203 text204 text205 text206 text207 text208 </span></a>
<a class="sourceLine" id="cb57-54" data-line-number="54"><span class="co">#&gt;       2       2       2       2       2       2       3       2 </span></a>
<a class="sourceLine" id="cb57-55" data-line-number="55"><span class="co">#&gt; text209 text210 text211 text212 text213 text214 text215 text216 </span></a>
<a class="sourceLine" id="cb57-56" data-line-number="56"><span class="co">#&gt;       2       2       1       2       1       2       2       2 </span></a>
<a class="sourceLine" id="cb57-57" data-line-number="57"><span class="co">#&gt; text217 text218 text219 text220 text221 text222 text223 text224 </span></a>
<a class="sourceLine" id="cb57-58" data-line-number="58"><span class="co">#&gt;       3       1       2       3       3       3       2       2 </span></a>
<a class="sourceLine" id="cb57-59" data-line-number="59"><span class="co">#&gt; text225 text226 text227 text228 text229 text230 text231 text232 </span></a>
<a class="sourceLine" id="cb57-60" data-line-number="60"><span class="co">#&gt;       2       2       3       2       1       3       2       2 </span></a>
<a class="sourceLine" id="cb57-61" data-line-number="61"><span class="co">#&gt; text233 text234 text235 text236 text237 text238 text239 text240 </span></a>
<a class="sourceLine" id="cb57-62" data-line-number="62"><span class="co">#&gt;       2       2       2       2       2       2       3       3 </span></a>
<a class="sourceLine" id="cb57-63" data-line-number="63"><span class="co">#&gt; text241 text242 text243 text244 text245 text246 text247 text248 </span></a>
<a class="sourceLine" id="cb57-64" data-line-number="64"><span class="co">#&gt;       3       3       3       2       1       1       1       2 </span></a>
<a class="sourceLine" id="cb57-65" data-line-number="65"><span class="co">#&gt; text249 text250 text251 text252 text253 text254 text255 text256 </span></a>
<a class="sourceLine" id="cb57-66" data-line-number="66"><span class="co">#&gt;       1       3       1       2       3       2       3       3 </span></a>
<a class="sourceLine" id="cb57-67" data-line-number="67"><span class="co">#&gt; text257 text258 text259 text260 text261 text262 text263 text264 </span></a>
<a class="sourceLine" id="cb57-68" data-line-number="68"><span class="co">#&gt;       1       2       2       3       3       3       3       3 </span></a>
<a class="sourceLine" id="cb57-69" data-line-number="69"><span class="co">#&gt; text265 text266 text267 text268 text269 text270 text271 text272 </span></a>
<a class="sourceLine" id="cb57-70" data-line-number="70"><span class="co">#&gt;       1       1       2       1       1       1       1       1 </span></a>
<a class="sourceLine" id="cb57-71" data-line-number="71"><span class="co">#&gt; text273 text274 text275 text276 text277 text278 text279 text280 </span></a>
<a class="sourceLine" id="cb57-72" data-line-number="72"><span class="co">#&gt;       3       1       1       3       1       1       3       3 </span></a>
<a class="sourceLine" id="cb57-73" data-line-number="73"><span class="co">#&gt; text281 text282 text283 text284 text285 text286 text287 text288 </span></a>
<a class="sourceLine" id="cb57-74" data-line-number="74"><span class="co">#&gt;       3       3       3       3       3       2       1       2 </span></a>
<a class="sourceLine" id="cb57-75" data-line-number="75"><span class="co">#&gt; text289 text290 text291 text292 text293 text294 text295 text296 </span></a>
<a class="sourceLine" id="cb57-76" data-line-number="76"><span class="co">#&gt;       1       2       1       1       1       3       1       1 </span></a>
<a class="sourceLine" id="cb57-77" data-line-number="77"><span class="co">#&gt; text297 text298 text299 text300 text301 text302 text303 text304 </span></a>
<a class="sourceLine" id="cb57-78" data-line-number="78"><span class="co">#&gt;       2       1       3       1       1       1       1       1 </span></a>
<a class="sourceLine" id="cb57-79" data-line-number="79"><span class="co">#&gt; text305 text306 text307 text308 text309 text310 text311 text312 </span></a>
<a class="sourceLine" id="cb57-80" data-line-number="80"><span class="co">#&gt;       1       1       3       3       1       3       3       1 </span></a>
<a class="sourceLine" id="cb57-81" data-line-number="81"><span class="co">#&gt; text313 text314 text315 text316 text317 text318 text319 text320 </span></a>
<a class="sourceLine" id="cb57-82" data-line-number="82"><span class="co">#&gt;       3       1       3       1       3       3       3       1 </span></a>
<a class="sourceLine" id="cb57-83" data-line-number="83"><span class="co">#&gt; text321 text322 text323 text324 text325 text326 text327 text328 </span></a>
<a class="sourceLine" id="cb57-84" data-line-number="84"><span class="co">#&gt;       1       1       2       1       2       2       1       2 </span></a>
<a class="sourceLine" id="cb57-85" data-line-number="85"><span class="co">#&gt; text329 text330 text331 text332 text333 text334 text335 text336 </span></a>
<a class="sourceLine" id="cb57-86" data-line-number="86"><span class="co">#&gt;       1       1       3       3       1       1       1       1 </span></a>
<a class="sourceLine" id="cb57-87" data-line-number="87"><span class="co">#&gt; text337 text338 text339 text340 text341 text342 text343 text344 </span></a>
<a class="sourceLine" id="cb57-88" data-line-number="88"><span class="co">#&gt;       1       1       2       1       1       1       1       1 </span></a>
<a class="sourceLine" id="cb57-89" data-line-number="89"><span class="co">#&gt; text345 text346 text347 text348 text349 text350 text351 text352 </span></a>
<a class="sourceLine" id="cb57-90" data-line-number="90"><span class="co">#&gt;       1       3       1       2       1       2       3       1 </span></a>
<a class="sourceLine" id="cb57-91" data-line-number="91"><span class="co">#&gt; text353 text354 text355 text356 text357 text358 text359 text360 </span></a>
<a class="sourceLine" id="cb57-92" data-line-number="92"><span class="co">#&gt;       1       3       2       3       1       3       2       1 </span></a>
<a class="sourceLine" id="cb57-93" data-line-number="93"><span class="co">#&gt; text361 text362 text363 text364 text365 text366 text367 text368 </span></a>
<a class="sourceLine" id="cb57-94" data-line-number="94"><span class="co">#&gt;       3       3       3       2       1       3       3       3 </span></a>
<a class="sourceLine" id="cb57-95" data-line-number="95"><span class="co">#&gt; text369 text370 text371 text372 text373 text374 text375 text376 </span></a>
<a class="sourceLine" id="cb57-96" data-line-number="96"><span class="co">#&gt;       3       3       1       1       1       3       3       2 </span></a>
<a class="sourceLine" id="cb57-97" data-line-number="97"><span class="co">#&gt; text377 text378 text379 text380 text381 text382 text383 text384 </span></a>
<a class="sourceLine" id="cb57-98" data-line-number="98"><span class="co">#&gt;       2       2       2       2       2       3       3       3 </span></a>
<a class="sourceLine" id="cb57-99" data-line-number="99"><span class="co">#&gt; text385 text386 text387 text388 text389 text390 text391 text392 </span></a>
<a class="sourceLine" id="cb57-100" data-line-number="100"><span class="co">#&gt;       3       1       2       2       3       1       1       3 </span></a>
<a class="sourceLine" id="cb57-101" data-line-number="101"><span class="co">#&gt; text393 text394 text395 text396 text397 text398 text399 text400 </span></a>
<a class="sourceLine" id="cb57-102" data-line-number="102"><span class="co">#&gt;       3       1       3       2       3       3       3       2 </span></a>
<a class="sourceLine" id="cb57-103" data-line-number="103"><span class="co">#&gt; text401 text402 text403 text404 text405 text406 text407 text408 </span></a>
<a class="sourceLine" id="cb57-104" data-line-number="104"><span class="co">#&gt;       3       3       2       1       3       3       2       3 </span></a>
<a class="sourceLine" id="cb57-105" data-line-number="105"><span class="co">#&gt; text409 text410 text411 text412 text413 text414 text415 text416 </span></a>
<a class="sourceLine" id="cb57-106" data-line-number="106"><span class="co">#&gt;       3       1       1       3       3       3       3       3 </span></a>
<a class="sourceLine" id="cb57-107" data-line-number="107"><span class="co">#&gt; text417 text418 text419 text420 text421 text422 text423 text424 </span></a>
<a class="sourceLine" id="cb57-108" data-line-number="108"><span class="co">#&gt;       3       1       3       3       3       3       3       3 </span></a>
<a class="sourceLine" id="cb57-109" data-line-number="109"><span class="co">#&gt; text425 text426 text427 text428 text429 text430 text431 text432 </span></a>
<a class="sourceLine" id="cb57-110" data-line-number="110"><span class="co">#&gt;       3       3       2       1       1       3       2       3 </span></a>
<a class="sourceLine" id="cb57-111" data-line-number="111"><span class="co">#&gt; text433 text434 text435 text436 text437 text438 text439 text440 </span></a>
<a class="sourceLine" id="cb57-112" data-line-number="112"><span class="co">#&gt;       3       3       1       1       1       3       3       1 </span></a>
<a class="sourceLine" id="cb57-113" data-line-number="113"><span class="co">#&gt; text441 text442 text443 text444 text445 text446 text447 text448 </span></a>
<a class="sourceLine" id="cb57-114" data-line-number="114"><span class="co">#&gt;       1       2       2       1       3       1       1       3 </span></a>
<a class="sourceLine" id="cb57-115" data-line-number="115"><span class="co">#&gt; text449 text450 text451 text452 text453 text454 text455 text456 </span></a>
<a class="sourceLine" id="cb57-116" data-line-number="116"><span class="co">#&gt;       3       3       3       3       3       1       1       1 </span></a>
<a class="sourceLine" id="cb57-117" data-line-number="117"><span class="co">#&gt; text457 text458 text459 text460 text461 text462 text463 text464 </span></a>
<a class="sourceLine" id="cb57-118" data-line-number="118"><span class="co">#&gt;       1       3       1       1       1       2       3       1 </span></a>
<a class="sourceLine" id="cb57-119" data-line-number="119"><span class="co">#&gt; text465 text466 text467 text468 text469 text470 text471 text472 </span></a>
<a class="sourceLine" id="cb57-120" data-line-number="120"><span class="co">#&gt;       3       2       3       1       3       2       3       3 </span></a>
<a class="sourceLine" id="cb57-121" data-line-number="121"><span class="co">#&gt; text473 text474 text475 text476 text477 text478 text479 text480 </span></a>
<a class="sourceLine" id="cb57-122" data-line-number="122"><span class="co">#&gt;       2       2       3       3       3       2       3       3 </span></a>
<a class="sourceLine" id="cb57-123" data-line-number="123"><span class="co">#&gt; text481 text482 text483 text484 text485 text486 text487 text488 </span></a>
<a class="sourceLine" id="cb57-124" data-line-number="124"><span class="co">#&gt;       3       3       3       1       2       3       2       3 </span></a>
<a class="sourceLine" id="cb57-125" data-line-number="125"><span class="co">#&gt; text489 text490 text491 text492 text493 text494 text495 text496 </span></a>
<a class="sourceLine" id="cb57-126" data-line-number="126"><span class="co">#&gt;       3       3       3       3       1       1       1       2 </span></a>
<a class="sourceLine" id="cb57-127" data-line-number="127"><span class="co">#&gt; text497 text498 text499 text500 text501 text502 text503 text504 </span></a>
<a class="sourceLine" id="cb57-128" data-line-number="128"><span class="co">#&gt;       3       1       3       1       1       1       3       1 </span></a>
<a class="sourceLine" id="cb57-129" data-line-number="129"><span class="co">#&gt; text505 text506 text507 text508 text509 text510 text511 text512 </span></a>
<a class="sourceLine" id="cb57-130" data-line-number="130"><span class="co">#&gt;       3       1       1       3       1       1       1       3 </span></a>
<a class="sourceLine" id="cb57-131" data-line-number="131"><span class="co">#&gt; text513 text514 text515 text516 text517 text518 text519 text520 </span></a>
<a class="sourceLine" id="cb57-132" data-line-number="132"><span class="co">#&gt;       1       1       2       3       1       3       1       1 </span></a>
<a class="sourceLine" id="cb57-133" data-line-number="133"><span class="co">#&gt; text521 text522 text523 text524 text525 text526 text527 text528 </span></a>
<a class="sourceLine" id="cb57-134" data-line-number="134"><span class="co">#&gt;       1       2       1       3       2       1       1       1 </span></a>
<a class="sourceLine" id="cb57-135" data-line-number="135"><span class="co">#&gt; text529 text530 text531 text532 text533 text534 text535 text536 </span></a>
<a class="sourceLine" id="cb57-136" data-line-number="136"><span class="co">#&gt;       1       1       3       1       1       1       1       3 </span></a>
<a class="sourceLine" id="cb57-137" data-line-number="137"><span class="co">#&gt; text537 text538 text539 text540 text541 text542 text543 text544 </span></a>
<a class="sourceLine" id="cb57-138" data-line-number="138"><span class="co">#&gt;       3       3       1       3       3       3       1       3 </span></a>
<a class="sourceLine" id="cb57-139" data-line-number="139"><span class="co">#&gt; text545 text546 text547 text548 text549 text550 text551 text552 </span></a>
<a class="sourceLine" id="cb57-140" data-line-number="140"><span class="co">#&gt;       1       3       3       3       1       1       1       3 </span></a>
<a class="sourceLine" id="cb57-141" data-line-number="141"><span class="co">#&gt; text553 text554 text555 text556 text557 text558 text559 text560 </span></a>
<a class="sourceLine" id="cb57-142" data-line-number="142"><span class="co">#&gt;       2       3       3       2       3       3       3       3 </span></a>
<a class="sourceLine" id="cb57-143" data-line-number="143"><span class="co">#&gt; text561 text562 text563 text564 text565 text566 text567 text568 </span></a>
<a class="sourceLine" id="cb57-144" data-line-number="144"><span class="co">#&gt;       1       1       1       1       1       1       2       3 </span></a>
<a class="sourceLine" id="cb57-145" data-line-number="145"><span class="co">#&gt; text569 text570 text571 text572 text573 text574 text575 text576 </span></a>
<a class="sourceLine" id="cb57-146" data-line-number="146"><span class="co">#&gt;       3       3       2       3       1       3       1       1 </span></a>
<a class="sourceLine" id="cb57-147" data-line-number="147"><span class="co">#&gt; text577 text578 text579 text580 text581 text582 text583 text584 </span></a>
<a class="sourceLine" id="cb57-148" data-line-number="148"><span class="co">#&gt;       2       3       1       3       1       1       1       1 </span></a>
<a class="sourceLine" id="cb57-149" data-line-number="149"><span class="co">#&gt; text585 text586 text587 text588 text589 text590 text591 text592 </span></a>
<a class="sourceLine" id="cb57-150" data-line-number="150"><span class="co">#&gt;       3       3       1       2       3       1       3       1 </span></a>
<a class="sourceLine" id="cb57-151" data-line-number="151"><span class="co">#&gt; text593 text594 text595 text596 text597 text598 text599 text600 </span></a>
<a class="sourceLine" id="cb57-152" data-line-number="152"><span class="co">#&gt;       3       1       3       3       2       2       1       3 </span></a>
<a class="sourceLine" id="cb57-153" data-line-number="153"><span class="co">#&gt; text601 text602 text603 text604 text605 text606 text607 text608 </span></a>
<a class="sourceLine" id="cb57-154" data-line-number="154"><span class="co">#&gt;       1       3       1       1       3       1       3       3 </span></a>
<a class="sourceLine" id="cb57-155" data-line-number="155"><span class="co">#&gt; text609 text610 text611 text612 text613 text614 text615 text616 </span></a>
<a class="sourceLine" id="cb57-156" data-line-number="156"><span class="co">#&gt;       1       1       3       1       1       2       1       1 </span></a>
<a class="sourceLine" id="cb57-157" data-line-number="157"><span class="co">#&gt; text617 text618 text619 text620 text621 text622 text623 text624 </span></a>
<a class="sourceLine" id="cb57-158" data-line-number="158"><span class="co">#&gt;       1       1       1       1       1       1       3       1 </span></a>
<a class="sourceLine" id="cb57-159" data-line-number="159"><span class="co">#&gt; text625 text626 text627 text628 text629 text630 text631 text632 </span></a>
<a class="sourceLine" id="cb57-160" data-line-number="160"><span class="co">#&gt;       3       3       1       3       2       1       1       1 </span></a>
<a class="sourceLine" id="cb57-161" data-line-number="161"><span class="co">#&gt; text633 text634 text635 text636 text637 text638 text639 text640 </span></a>
<a class="sourceLine" id="cb57-162" data-line-number="162"><span class="co">#&gt;       1       1       3       1       1       1       1       2 </span></a>
<a class="sourceLine" id="cb57-163" data-line-number="163"><span class="co">#&gt; text641 text642 text643 text644 text645 text646 text647 text648 </span></a>
<a class="sourceLine" id="cb57-164" data-line-number="164"><span class="co">#&gt;       2       2       1       3       1       3       1       1 </span></a>
<a class="sourceLine" id="cb57-165" data-line-number="165"><span class="co">#&gt; text649 text650 text651 text652 text653 text654 text655 text656 </span></a>
<a class="sourceLine" id="cb57-166" data-line-number="166"><span class="co">#&gt;       2       3       2       3       1       3       1       1 </span></a>
<a class="sourceLine" id="cb57-167" data-line-number="167"><span class="co">#&gt; text657 text658 text659 text660 text661 text662 text663 text664 </span></a>
<a class="sourceLine" id="cb57-168" data-line-number="168"><span class="co">#&gt;       3       1       3       1       1       1       1       1 </span></a>
<a class="sourceLine" id="cb57-169" data-line-number="169"><span class="co">#&gt; text665 text666 text667 text668 text669 text670 text671 text672 </span></a>
<a class="sourceLine" id="cb57-170" data-line-number="170"><span class="co">#&gt;       2       2       2       3       2       1       3       3 </span></a>
<a class="sourceLine" id="cb57-171" data-line-number="171"><span class="co">#&gt; text673 text674 text675 text676 text677 text678 text679 text680 </span></a>
<a class="sourceLine" id="cb57-172" data-line-number="172"><span class="co">#&gt;       3       3       3       3       3       3       3       1 </span></a>
<a class="sourceLine" id="cb57-173" data-line-number="173"><span class="co">#&gt; text681 text682 text683 text684 text685 text686 text687 text688 </span></a>
<a class="sourceLine" id="cb57-174" data-line-number="174"><span class="co">#&gt;       3       3       3       1       2       3       3       3 </span></a>
<a class="sourceLine" id="cb57-175" data-line-number="175"><span class="co">#&gt; text689 text690 text691 text692 text693 text694 text695 text696 </span></a>
<a class="sourceLine" id="cb57-176" data-line-number="176"><span class="co">#&gt;       3       3       3       3       3       3       2       2 </span></a>
<a class="sourceLine" id="cb57-177" data-line-number="177"><span class="co">#&gt; text697 text698 text699 text700 text701 text702 text703 text704 </span></a>
<a class="sourceLine" id="cb57-178" data-line-number="178"><span class="co">#&gt;       3       1       1       3       3       1       2       3 </span></a>
<a class="sourceLine" id="cb57-179" data-line-number="179"><span class="co">#&gt; text705 text706 text707 text708 text709 text710 text711 text712 </span></a>
<a class="sourceLine" id="cb57-180" data-line-number="180"><span class="co">#&gt;       1       1       3       3       3       2       1       1 </span></a>
<a class="sourceLine" id="cb57-181" data-line-number="181"><span class="co">#&gt; text713 text714 text715 text716 text717 text718 text719 text720 </span></a>
<a class="sourceLine" id="cb57-182" data-line-number="182"><span class="co">#&gt;       3       3       2       3       2       3       1       1 </span></a>
<a class="sourceLine" id="cb57-183" data-line-number="183"><span class="co">#&gt; text721 text722 text723 text724 text725 text726 text727 text728 </span></a>
<a class="sourceLine" id="cb57-184" data-line-number="184"><span class="co">#&gt;       3       3       3       3       2       1       1       3 </span></a>
<a class="sourceLine" id="cb57-185" data-line-number="185"><span class="co">#&gt; text729 text730 </span></a>
<a class="sourceLine" id="cb57-186" data-line-number="186"><span class="co">#&gt;       3       3</span></a></code></pre></div>
<p>We now build the bar plot to inspect the per-topic-per-word probabilities (beta’s). We take the 10 top terms and rearrange the beta per topic according to this order.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb58-1" data-line-number="1"></a>
<a class="sourceLine" id="cb58-2" data-line-number="2">beta.td.combine&lt;-<span class="kw">tidy</span>(lda_combine,<span class="dt">matrix=</span><span class="st">&quot;beta&quot;</span>)</a>
<a class="sourceLine" id="cb58-3" data-line-number="3"></a>
<a class="sourceLine" id="cb58-4" data-line-number="4">beta.top.term.combine&lt;-beta.td.combine <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb58-5" data-line-number="5"><span class="st">  </span><span class="kw">group_by</span>(topic) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb58-6" data-line-number="6"><span class="st">  </span><span class="kw">top_n</span>(<span class="dv">10</span>, beta) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb58-7" data-line-number="7"><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb58-8" data-line-number="8"><span class="st">  </span><span class="kw">arrange</span>(topic, <span class="op">-</span>beta)</a>
<a class="sourceLine" id="cb58-9" data-line-number="9"></a>
<a class="sourceLine" id="cb58-10" data-line-number="10">beta.top.term.combine <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb58-11" data-line-number="11"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">term=</span><span class="kw">reorder_within</span>(term, beta, topic)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb58-12" data-line-number="12"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(term,beta,<span class="dt">fill=</span><span class="kw">factor</span>(topic))) <span class="op">+</span></a>
<a class="sourceLine" id="cb58-13" data-line-number="13"><span class="st">  </span><span class="kw">geom_col</span>(<span class="dt">show.legend =</span> <span class="ot">FALSE</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb58-14" data-line-number="14"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>topic, <span class="dt">scales =</span> <span class="st">&quot;free&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb58-15" data-line-number="15"><span class="st">  </span><span class="kw">coord_flip</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb58-16" data-line-number="16"><span class="st">  </span><span class="kw">scale_x_reordered</span>()</a></code></pre></div>
<p><img src="Text-Mining_files/figure-html/unnamed-chunk-267-1.png" width="70%" style="display: block; margin: auto;" /></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="similarities.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="word-embedding.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
